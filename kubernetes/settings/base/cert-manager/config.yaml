---
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: lunes@uv.do
    privateKeySecretRef:
      name: letsencrypt-prod-account-key
    solvers:
      - http01:
          gatewayHTTPRoute:
            parentRefs:
              # Argo
              - name: argo-traefik-gateway
                namespace: nm-traefik
                kind: Gateway
                sectionName: web

              # Monitoring
              - name: grafana-traefik-gateway
                namespace: nm-traefik
                kind: Gateway
                sectionName: web

              - name: prometeheus-traefik-gateway
                namespace: nm-traefik
                kind: Gateway
                sectionName: web

              - name: alloy-traefik-gateway
                namespace: nm-traefik
                kind: Gateway
                sectionName: web

              # App
              - name: lune-traefik-gateway
                namespace: nm-traefik
                kind: Gateway
                sectionName: web

              # Gitlab
              - name: gitlab-traefik-gateway
                namespace: nm-traefik
                kind: Gateway
                sectionName: web

              # Artifactory
              - name: nexus-traefik-gateway
                namespace: nm-traefik
                kind: Gateway
                sectionName: web
